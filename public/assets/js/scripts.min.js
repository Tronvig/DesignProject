/*!
 * DesignProject
 * Form Creation App
 * https://github.com/Tronvig/DesignProject/
 * @author Matt Tronvig
 * @version 1.0.0
 * Copyright 2017. MIT licensed.
 */
!function(e,o,t,n){"use strict";e(function(){function n(){var n=e(o).scrollTop();Math.abs(c-n)<=m||(n>c&&n>d?e("header").removeClass("header--down").addClass("header--up"):n+e(o).height()<e(t).height()&&e("header").removeClass("header--up").addClass("header--down"),c=n)}function a(){e(".mobile-nav").removeClass("animate-inFromRight"),e(".mobile-nav").addClass("animate-outToLeft"),e(".mobile-nav").removeClass("active"),e(".icon__hamburger").removeClass("active"),setTimeout(function(){e("body").removeClass("menu-open")},1200)}function i(){e(".icon__hamburger").addClass("active"),e("body").toggleClass("menu-open"),e(".mobile-nav").toggleClass("active"),e(".mobile-nav").removeClass("animate-outToLeft"),e(".mobile-nav").addClass("animate-inFromRight");var o=["nav__item--1","nav__item--2","nav__item--3","nav__item--4","nav__item--5","nav__item--6","nav__item--7","nav__item--8","nav__item--9"];e(".nav__level .nav__item").each(function(t,n){e(n).addClass(o[t])})}function r(o){e("body").hasClass(o)||(e("body").removeClass(),e(".signup").removeClass("active"),e(".login").removeClass("active"),e(".auth").removeClass("active"),e(".prospect").removeClass("active"),e("body").addClass("forms-open"),e("body").addClass(o),e(".forms").addClass("active"),e(o).addClass("active")),p&&(a(),p=!p),v=!0}function s(o){v&&(e("body").toggleClass("forms-open"),e("body").toggleClass(o),e(".forms").toggleClass("active"),e(o).toggleClass("active")),v=!v}function l(){e(".provider").addClass("on"),e(".credentials").removeClass("on"),e(".terms").removeClass("on")}new Rellax(".rellax");e(o).on("load",function(){e("body").removeClass("preload")});var u,c=0,m=5,d=e("header").outerHeight();e(o).scroll(function(){u=!0}),setInterval(function(){u&&(n(),u=!1)},250),e("label input").on("focus",function(){var o=e(this).val();o.length<1&&e(this).parent().toggleClass("on")});var p=!1;e(".icon__hamburger").on("click",function(){p?a():i(),p=!p});var v=!1;e(".menu--login").click(function(){return r(".login"),!1}),e(".mobile-nav--login").click(function(){return r(".login"),!1}),e(".signup--login").click(function(){return r(".login"),!1}),e(".menu--signup").click(function(){return r(".signup"),!1}),e(".mobile-nav--signup").click(function(){return r(".signup"),!1}),e(".login--signup").click(function(){return r(".signup"),!1}),e(".cta--signup").click(function(){return r(".signup"),!1}),e(".login--dismiss").click(function(){return s(".login"),!1}),e(".signup--dismiss").click(function(){return s(".signup"),l(),!1}),e(".prospect--dismiss").click(function(){return s(".prospect"),l(),!1}),e(".auth--dismiss").click(function(){return s(".auth"),l(),!1}),e(".success--dismiss").click(function(){return s(".success"),!1}),e(".attribution").click(function(o){o.preventDefault(),e(".provider").toggleClass("on"),e(".credentials").toggleClass("on");var t=e(this).attr("id");e("#attribution").val(t),e('input[name="attributionProvider"]').val(t),"Adjust"===t||"Appsflyer"===t?(e(".attr-provider").text(t+" as your attribution provider"),s(".signup"),r(".prospect")):"None"===t&&(e(".attr-provider").text("no attribution provider"),s(".signup"),r(".prospect"))}),e(".show-terms").click(function(o){o.preventDefault(),e(".credentials").toggleClass("on"),e(".terms").toggleClass("on")});var g="https://mv-managerapi.tune.com",f="https://app.multiverse.com";e("#signupForm").submit(function(t){e("#signupForm .error").hide(),e(".terms").toggleClass("on"),t.preventDefault();var n=e(this),a=n.find('input[name="FirstName"]').val(),i=n.find('input[name="LastName"]').val(),s=n.find('input[name="Company"]').val(),l=n.find('input[name="email"]').val(),u=n.find('input[name="pass"]').val(),c=n.find('input[name="attribution"]').val(),m=(n.attr("action"),e.ajax({type:"POST",url:g+"/session",contentType:"application/json",data:JSON.stringify({email:l,password:u})}));m.done(function(t){if("undefined"!=typeof t.token&&"undefined"!=typeof t.token.type&&null!==t.token.type&&"2factor"==t.token.type&&null!==t.token.token){e("body").removeClass("loading");var n=t.token.token;e("#twoFactorForm").attr("auth_token",n),e("#twoFactorForm").attr("email",l),r(".auth")}else{var u=t.token.token;createCookie("sessionCookie",u);var m=MktoForms2.getForm(1099);m.addHiddenFields({FirstName:a,LastName:i,Company:s,Email:l,attributionProvider:c}),m.submit(),m.onSuccess(function(e,t){return o.location.replace(f+"/login/"+u),!1})}}),m.error(function(o,t){var n=418===o.status?"Error: Unfortunately, only TMC AA users with administrator permissions may use Multiverse. Please work with a team member that has administrator access to use Multiverse.":"Failed to authenticate. Please check your e-mail and password.";e("body").removeClass("loading"),e(".credentials").toggleClass("on"),e("#signupForm .error").text(n),e("#signupForm .error").show()})}),e("#login").submit(function(t){e("body").addClass("loading"),e("#loginForm .error").hide(),t.preventDefault();var n=e(this),a=n.find('input[name="email"]').val(),i=n.find('input[name="pass"]').val(),s=e.ajax({type:"POST",url:g+"/session",contentType:"application/json",data:JSON.stringify({email:a,password:i})});s.done(function(t){if("undefined"!=typeof t.token&&"undefined"!=typeof t.token.type&&null!==t.token.type&&"2factor"==t.token.type&&null!==t.token.token){e("body").removeClass("loading");var n=t.token.token;e("#twoFactorForm").attr("auth_token",n),e("#twoFactorForm").attr("email",a),r(".auth")}else{var i=t.token.token;createCookie("sessionCookie",i),o.location.replace(f+"/login/"+i)}}),s.error(function(o,t){r(".login");var n=418===o.status?"Error: Unfortunately, only TMC AA users with administrator permissions may use Multiverse. Please work with a team member that has administrator access to use Multiverse.":"Failed to authenticate. Please check your e-mail and password.";e("body").removeClass("loading"),e("#loginForm .error").text(n),e("#loginForm .error").show()})}),e("#loginForm").submit(function(t){e("body").addClass("loading"),e("#loginForm .error").hide(),t.preventDefault();var n=e(this),a=n.find('input[name="email"]').val(),i=n.find('input[name="pass"]').val(),s=e.ajax({type:"POST",url:g+"/session",contentType:"application/json",data:JSON.stringify({email:a,password:i})});s.done(function(t){if("undefined"!=typeof t.token&&"undefined"!=typeof t.token.type&&null!==t.token.type&&"2factor"==t.token.type&&null!==t.token.token){e("body").removeClass("loading");var n=t.token.token;e("#twoFactorForm").attr("auth_token",n),e("#twoFactorForm").attr("email",a),r(".auth")}else{var i=t.token.token;createCookie("sessionCookie",i),o.location.replace(f+"/login/"+i)}}),s.error(function(o,t){var n=418===o.status?"Error: Unfortunately, only TMC AA users with administrator permissions may use Multiverse. Please work with a team member that has administrator access to use Multiverse.":"Failed to authenticate. Please check your e-mail and password.";e("body").removeClass("loading"),e("#loginForm .error").text(n),e("#loginForm .error").show()})}),e("#twoFactorForm").submit(function(t){e("body").addClass("loading"),e("#twoFactorForm .error").hide(),t.preventDefault();var n=e(this),a=n.find('input[name="code"]').val(),i=(e("#twoFactorForm").attr("email"),e("#twoFactorForm").attr("auth_token")),r=e.ajax({type:"POST",url:g+"/session",contentType:"application/json",data:JSON.stringify({auth_token:i,code:a})});r.done(function(t){if("undefined"!=typeof t.error_msg&&null!==t.error_msg)e("body").removeClass("loading"),e("#twoFactorForm .error").text(t.error_msg),e("#twoFactorForm .error").show();else{var n=t.token.token;createCookie("sessionCookie",n),o.location.replace(f+"/login/"+n)}}),r.error(function(o,t){var n="Failed to authenticate. Invalid verification code.";e("body").removeClass("loading"),e("#twoFactorForm .error").text(n),e("#twoFactorForm .error").show()})});var h=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp("[\\?&]"+e+"=([^&#]*)"),t=o.exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},k=h("message");"thank-you"===k&&r(".success")})}(jQuery,window,document);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsImRvY3VtZW50IiwidW5kZWZpbmVkIiwiaGFzU2Nyb2xsZWQiLCJzdCIsInNjcm9sbFRvcCIsIk1hdGgiLCJhYnMiLCJsYXN0U2Nyb2xsVG9wIiwiZGVsdGEiLCJoZWFkZXJIZWlnaHQiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiaGVpZ2h0IiwiaGlkZU1vYmlsZU5hdiIsInNldFRpbWVvdXQiLCJzaG93TW9iaWxlTmF2IiwidG9nZ2xlQ2xhc3MiLCJjbGFzc2VzIiwiZWFjaCIsImluZGV4IiwiZWxlbWVudCIsInNob3dGb3JtcyIsImZvcm0iLCJoYXNDbGFzcyIsImlzSGFtYnVyZ2VyQWN0aXZlIiwiaXNGb3JtQWN0aXZlIiwiY2xvc2VGb3JtcyIsInJlc2V0U2lnbnVwIiwiUmVsbGF4Iiwib24iLCJkaWRTY3JvbGwiLCJvdXRlckhlaWdodCIsInNjcm9sbCIsInNldEludGVydmFsIiwiaW5wdXRWYWwiLCJ0aGlzIiwidmFsIiwibGVuZ3RoIiwicGFyZW50IiwiY2xpY2siLCJlIiwicHJldmVudERlZmF1bHQiLCJhdHRyaWJ1dGlvbiIsImF0dHIiLCJ0ZXh0IiwiQVBJX1VSTCIsIldFQkFQUF9VUkwiLCJzdWJtaXQiLCJldmVudCIsImhpZGUiLCIkZm9ybSIsImZpcnN0bmFtZSIsImZpbmQiLCJsYXN0bmFtZSIsImNvbXBhbnkiLCJlbWFpbCIsInBhc3N3b3JkIiwic2lnbnVwIiwiYWpheCIsInR5cGUiLCJ1cmwiLCJjb250ZW50VHlwZSIsImRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwiZG9uZSIsInRva2VuIiwiYTJmVG9rZW4iLCJzZXNzaW9uX3Rva2VuIiwiY3JlYXRlQ29va2llIiwibWFya2V0b0Zvcm0iLCJNa3RvRm9ybXMyIiwiZ2V0Rm9ybSIsImFkZEhpZGRlbkZpZWxkcyIsIkZpcnN0TmFtZSIsIkxhc3ROYW1lIiwiQ29tcGFueSIsIkVtYWlsIiwiYXR0cmlidXRpb25Qcm92aWRlciIsIm9uU3VjY2VzcyIsInZhbHVlcyIsImZvbGxvd1VwVXJsIiwibG9jYXRpb24iLCJyZXBsYWNlIiwiZXJyb3IiLCJodHRwT2JqIiwidGV4dFN0YXR1cyIsImVycm9yTWVzc2FnZSIsInN0YXR1cyIsInNob3ciLCJwb3N0aW5nIiwiY29kZSIsImF1dGhfdG9rZW4iLCJlcnJvcl9tc2ciLCJnZXRQYXJhbWV0ZXJCeU5hbWUiLCJuYW1lIiwicmVnZXgiLCJSZWdFeHAiLCJyZXN1bHRzIiwiZXhlYyIsInNlYXJjaCIsImRlY29kZVVSSUNvbXBvbmVudCIsInBhcmFtIiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiOzs7Ozs7OztDQUFBLFNBQUFBLEVBQUFDLEVBQUFDLEVBQUFDLEdBRUEsWUFFQUgsR0FBQSxXQWdCQSxRQUFBSSxLQUNBLEdBQUFDLEdBQUFMLEVBQUFDLEdBQUFLLFdBR0FDLE1BQUFDLElBQUFDLEVBQUFKLElBQUFLLElBTUFMLEVBQUFJLEdBQUFKLEVBQUFNLEVBRUFYLEVBQUEsVUFBQVksWUFBQSxnQkFBQUMsU0FBQSxjQUdBUixFQUFBTCxFQUFBQyxHQUFBYSxTQUFBZCxFQUFBRSxHQUFBWSxVQUNBZCxFQUFBLFVBQUFZLFlBQUEsY0FBQUMsU0FBQSxnQkFJQUosRUFBQUosR0EyQkEsUUFBQVUsS0FFQWYsRUFBQSxlQUFBWSxZQUFBLHVCQUNBWixFQUFBLGVBQUFhLFNBQUEscUJBQ0FiLEVBQUEsZUFBQVksWUFBQSxVQUdBWixFQUFBLG9CQUFBWSxZQUFBLFVBQ0FJLFdBQUEsV0FDQWhCLEVBQUEsUUFBQVksWUFBQSxjQUNBLE1BS0EsUUFBQUssS0FFQWpCLEVBQUEsb0JBQUFhLFNBQUEsVUFDQWIsRUFBQSxRQUFBa0IsWUFBQSxhQUNBbEIsRUFBQSxlQUFBa0IsWUFBQSxVQUNBbEIsRUFBQSxlQUFBWSxZQUFBLHFCQUNBWixFQUFBLGVBQUFhLFNBQUEsc0JBR0EsSUFBQU0sSUFDQSxlQUNBLGVBQ0EsZUFDQSxlQUNBLGVBQ0EsZUFDQSxlQUNBLGVBQ0EsZUFHQW5CLEdBQUEsMEJB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R0FBQUMsUUFBQSxTQUFBRixFQUFBLGFBQ0FHLEVBQUFGLEVBQUFHLEtBQUFqQixTQUFBa0IsT0FDQSxPQUFBLFFBQUFGLEVBQUEsR0FBQUcsbUJBQUFILEVBQUEsR0FBQWYsUUFBQSxNQUFBLE9BR0FtQixFQUFBUixFQUFBLFVBR0EsZUFBQVEsR0FDQWpGLEVBQUEsZUFPQWtGLE9BQUF4RyxPQUFBQyIsImZpbGUiOiJzY3JpcHRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gICQoZnVuY3Rpb24gKCkge1xuXG4gICAgLy8gUmVsbGF4IC0gUGFyYWxsYXggYW5pbWF0aW9uc1xuICAgIHZhciByZWxsYXggPSBuZXcgUmVsbGF4KCcucmVsbGF4Jyk7XG5cbiAgICAvLyBPbiBwYWdlIGxvYWQgcmVtb3ZlIHByZWxvYWQgY2xhc3MgZnJvbSBib2R5XG4gICAgJCh3aW5kb3cpLm9uKCdsb2FkJywgZnVuY3Rpb24oKSB7XG4gICAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ3ByZWxvYWQnKTtcbiAgICB9KTtcblxuICAgIC8vIEhpZGUgLmhlYWRlciBvbiBzY3JvbGwgZG93biBhbmQgc2hvdyBoZWFkZXIgb24gc2Nyb2xsIHVwXG4gICAgdmFyIGRpZFNjcm9sbDtcbiAgICB2YXIgbGFzdFNjcm9sbFRvcCA9IDA7XG4gICAgdmFyIGRlbHRhID0gNTtcbiAgICB2YXIgaGVhZGVySGVpZ2h0ID0gJCgnaGVhZGVyJykub3V0ZXJIZWlnaHQoKTtcblxuICAgIGZ1bmN0aW9uIGhhc1Njcm9sbGVkKCkge1xuICAgICAgICB2YXIgc3QgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XG5cbiAgICAgICAgLy8gTWFrZSBzdXJlIHRoZXkgc2Nyb2xsIG1vcmUgdGhhbiBkZWx0YVxuICAgICAgICBpZihNYXRoLmFicyhsYXN0U2Nyb2xsVG9wIC0gc3QpIDw9IGRlbHRhKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB0aGV5IHNjcm9sbGVkIGRvd24gYW5kIGFyZSBwYXN0IHRoZSBoZWFkZXIsIGFkZCBjbGFzcyAuaGVhZGVyLXVwLlxuICAgICAgICAvLyBUaGlzIGlzIG5lY2Vzc2FyeSBzbyB5b3UgbmV2ZXIgc2VlIHdoYXQgaXMgXCJiZWhpbmRcIiB0aGUgaGVhZGVyLlxuICAgICAgICBpZiAoc3QgPiBsYXN0U2Nyb2xsVG9wICYmIHN0ID4gaGVhZGVySGVpZ2h0KXtcbiAgICAgICAgICAgIC8vIFNjcm9sbCBEb3duXG4gICAgICAgICAgICAkKCdoZWFkZXInKS5yZW1vdmVDbGFzcygnaGVhZGVyLS1kb3duJykuYWRkQ2xhc3MoJ2hlYWRlci0tdXAnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFNjcm9sbCBVcFxuICAgICAgICAgICAgaWYoc3QgKyAkKHdpbmRvdykuaGVpZ2h0KCkgPCAkKGRvY3VtZW50KS5oZWlnaHQoKSkge1xuICAgICAgICAgICAgICAgICQoJ2hlYWRlcicpLnJlbW92ZUNsYXNzKCdoZWFkZXItLXVwJykuYWRkQ2xhc3MoJ2hlYWRlci0tZG93bicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgbGFzdFNjcm9sbFRvcCA9IHN0O1xuICAgIH1cblxuICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKXtcbiAgICAgICAgZGlkU2Nyb2xsID0gdHJ1ZTtcbiAgICB9KTtcblxuICAgIHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoZGlkU2Nyb2xsKSB7XG4gICAgICAgICAgICBoYXNTY3JvbGxlZCgpO1xuICAgICAgICAgICAgZGlkU2Nyb2xsID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9LCAyNTApO1xuXG4gICAgLy8gQ29udHJvbCBpbnB1dCBsYWJlbCBwb3NpdGlvbiBvbiBmb2N1c1xuICAgICQoJ2xhYmVsIGlucHV0Jykub24oJ2ZvY3VzJyxmdW5jdGlvbigpe1xuICAgICAgICB2YXIgaW5wdXRWYWwgPSAkKHRoaXMpLnZhbCgpO1xuICAgICAgICBpZiAoaW5wdXRWYWwubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICQodGhpcykucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ29uJyk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIE1vYmlsZSBOYXZcbiAgICAvLyBIYW1idXJnZXIgbWVudSBmb3IgbW9iaWxlIGRlcml2ZWQgZnJvbTogaHR0cHM6Ly9jb2RlcGVuLmlvL2FsZXhuZXdtYW4vcGVuL0J5ZVBvZFxuICAgIHZhciBpc0hhbWJ1cmdlckFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgLy8gU2hvdyB0aGUgbW9iaWxlIG5hdlxuICAgIGZ1bmN0aW9uIGhpZGVNb2JpbGVOYXYoKSB7XG4gICAgICAvLyBhbmltYXRlIHRoZSBuYXYgZXhpdFxuICAgICAgJCgnLm1vYmlsZS1uYXYnKS5yZW1vdmVDbGFzcygnYW5pbWF0ZS1pbkZyb21SaWdodCcpO1xuICAgICAgJCgnLm1vYmlsZS1uYXYnKS5hZGRDbGFzcygnYW5pbWF0ZS1vdXRUb0xlZnQnKTtcbiAgICAgICQoJy5tb2JpbGUtbmF2JykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAvLyBkZWxheSBoaWRpbmcgdGhlIG5hdlxuICAgICAgJCgnLmljb25fX2hhbWJ1cmdlcicpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygnbWVudS1vcGVuJyk7XG4gICAgICB9LCAxMjAwKTtcblxuICAgIH1cblxuICAgIC8vIEhpZGUgdGhlIG1vYmlsZSBuYXZcbiAgICBmdW5jdGlvbiBzaG93TW9iaWxlTmF2KCkge1xuXG4gICAgICAgICQoJy5pY29uX19oYW1idXJnZXInKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICQoJ2JvZHknKS50b2dnbGVDbGFzcygnbWVudS1vcGVuJyk7XG4gICAgICAgICQoJy5tb2JpbGUtbmF2JykudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKCcubW9iaWxlLW5hdicpLnJlbW92ZUNsYXNzKCdhbmltYXRlLW91dFRvTGVmdCcpO1xuICAgICAgICAkKCcubW9iaWxlLW5hdicpLmFkZENsYXNzKCdhbmltYXRlLWluRnJvbVJpZ2h0Jyk7XG5cbiAgICAgICAgLy8gTGlzdCBvZiBuYXYgaXRlbXMgaW4gdGhlIG1vYmlsZSBuYXYgLSBzd2l0Y2ggdG8gZHluYW1pYyBsaXN0IGluIGZ1dHVyZVxuICAgICAgICB2YXIgY2xhc3NlcyA9IFtcbiAgICAgICAgICAnbmF2X19pdGVtLS0xJyxcbiAgICAgICAgICAnbmF2X19pdGVtLS0yJyxcbiAgICAgICAgICAnbmF2X19pdGVtLS0zJyxcbiAgICAgICAgICAnbmF2X19pdGVtLS00JyxcbiAgICAgICAgICAnbmF2X19pdGVtLS01JyxcbiAgICAgICAgICAnbmF2X19pdGVtLS02JyxcbiAgICAgICAgICAnbmF2X19pdGVtLS03JyxcbiAgICAgICAgICAnbmF2X19pdGVtLS04JyxcbiAgICAgICAgICAnbmF2X19pdGVtLS05J1xuICAgICAgICAgIF07XG5cbiAgICAgICAgJCgnLm5hdl9fbGV2ZWwgLm5hdl9faXRlbScpLmVhY2goZnVuY3Rpb24oaW5kZXgsIGVsZW1lbnQpe1xuICAgICAgICAgICAgJChlbGVtZW50KS5hZGRDbGFzcyhjbGFzc2VzW2luZGV4XSk7XG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG4gICAgJCgnLmljb25fX2hhbWJ1cmdlcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKGlzSGFtYnVyZ2VyQWN0aXZlKSB7XG4gICAgICAgIGhpZGVNb2JpbGVOYXYoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNob3dNb2JpbGVOYXYoKTtcbiAgICAgIH1cblxuICAgICAgaXNIYW1idXJnZXJBY3RpdmUgPSAhaXNIYW1idXJnZXJBY3RpdmU7XG4gICAgfSk7XG5cbiAgICAvLyBTaWdudXAgJiBMb2dpbiBGb3Jtc1xuICAgIC8vXG4gICAgLy8gRm9ybSB0cmlnZ2VyczpcbiAgICAvLyBMb2dpbjogbWVudS0tbG9naW4sIHNpZ251cC0tbG9naW4sIG1vYmlsZS1uYXYtLWxvZ2luXG4gICAgLy8gU2lnbnVwOiBtZW51LS1zaWdudXAsIGN0YS0tc2lnbnVwLCBsb2dpbi0tc2lnbnVwLCBtb2JpbGUtbmF2LS1zaWdudXBcbiAgICAvL1xuXG4gICAgdmFyIGlzRm9ybUFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgLy8gU2hvdyB0aGUgcmVxdWVzdGVkIGZvcm1cbiAgICBmdW5jdGlvbiBzaG93Rm9ybXMoZm9ybSkge1xuICAgICAgaWYgKCQoJ2JvZHknKS5oYXNDbGFzcyhmb3JtKSkge1xuXG4gICAgICAgIC8vIGRvIG5vdGhpbmcsIHJlcXVlc3RlZCBmb3JtIGlzIGFscmVhZHkgc2hvd25cblxuICAgICAgfSBlbHNlIHtcblxuICAgICAgICAvLyBSZW1vdmUgY2xhc3NlcyBmcm9tIGJvZHkgJiBmb3Jtc1xuICAgICAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoKTtcbiAgICAgICAgJCgnLnNpZ251cCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgJCgnLmxvZ2luJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKCcuYXV0aCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgJCgnLnByb3NwZWN0JykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgIC8vIFNob3cgdGhlIHJlcXVlc3RlZCBmb3JtXG4gICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnZm9ybXMtb3BlbicpO1xuICAgICAgICAkKCdib2R5JykuYWRkQ2xhc3MoZm9ybSk7XG4gICAgICAgICQoJy5mb3JtcycpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgJChmb3JtKS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgIH1cblxuICAgICAgLy8gSGlkZSB0aGUgbW9iaWxlIG5hdiBpZiBpdCdzIGFjdGl2ZVxuICAgICAgaWYgKGlzSGFtYnVyZ2VyQWN0aXZlKSB7XG4gICAgICAgIGhpZGVNb2JpbGVOYXYoKTtcbiAgICAgICAgaXNIYW1idXJnZXJBY3RpdmUgPSAhaXNIYW1idXJnZXJBY3RpdmU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBkbyBub3RoaW5nXG4gICAgICB9XG5cbiAgICAgIGlzRm9ybUFjdGl2ZSA9IHRydWU7XG4gICAgfVxuICAgIC8vIENsb3NlIHRoZSBvcGVuIGZvcm1cbiAgICBmdW5jdGlvbiBjbG9zZUZvcm1zKGZvcm0pIHtcbiAgICAgIGlmIChpc0Zvcm1BY3RpdmUpIHtcblxuICAgICAgICAkKCdib2R5JykudG9nZ2xlQ2xhc3MoJ2Zvcm1zLW9wZW4nKTtcbiAgICAgICAgJCgnYm9keScpLnRvZ2dsZUNsYXNzKGZvcm0pO1xuICAgICAgICAkKCcuZm9ybXMnKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICQoZm9ybSkudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBkbyBub3RoaW5nXG4gICAgICB9XG5cbiAgICAgIGlzRm9ybUFjdGl2ZSA9ICFpc0Zvcm1BY3RpdmU7XG4gICAgfVxuXG4gICAgLy8gUmVzZXQgdGhlIFNpZ24gdXBcbiAgICBmdW5jdGlvbiByZXNldFNpZ251cCgpIHtcblxuICAgICAgICAvLyBTaG93IGZpcnN0IHN0ZXBcbiAgICAgICAgJCgnLnByb3ZpZGVyJykuYWRkQ2xhc3MoJ29uJyk7XG5cbiAgICAgICAgLy8gUmVtb3ZlIHByb2dyZXNzXG4gICAgICAgICQoJy5jcmVkZW50aWFscycpLnJlbW92ZUNsYXNzKCdvbicpO1xuICAgICAgICAkKCcudGVybXMnKS5yZW1vdmVDbGFzcygnb24nKTtcblxuICAgIH1cblxuICAgIC8vIExvZ2luIGZvcm0gdHJpZ2dlcnNcbiAgICAvL1xuICAgIC8vIFNob3cgbG9naW4gZm9ybSBmcm9tIG1haW4gbmF2XG4gICAgJCgnLm1lbnUtLWxvZ2luJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgc2hvd0Zvcm1zKCcubG9naW4nKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICAgIC8vIFNob3cgbG9naW4gZm9ybSBmcm9tIG1vYmlsZSBuYXZcbiAgICAkKCcubW9iaWxlLW5hdi0tbG9naW4nKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICBzaG93Rm9ybXMoJy5sb2dpbicpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gICAgLy8gU2hvdyBsb2dpbiBmb3JtIGZyb20gc2lnbnVwXG4gICAgJCgnLnNpZ251cC0tbG9naW4nKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICBzaG93Rm9ybXMoJy5sb2dpbicpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gICAgLy8gXiBDT01CSU5FIFRIRVNFXG5cbiAgICAvLyBTaWduIHVwIGZvcm0gdHJpZ2dlcnNcbiAgICAvL1xuICAgIC8vIFNob3cgc2lnbiB1cCBmb3JtIGZyb20gbWFpbiBuYXZcbiAgICAkKCcubWVudS0tc2lnbnVwJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgc2hvd0Zvcm1zKCcuc2lnbnVwJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgICAvLyBTaG93IHNpZ24gdXAgZm9ybSBmcm9tIG1vYmlsZSBuYXZcbiAgICAkKCcubW9iaWxlLW5hdi0tc2lnbnVwJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgc2hvd0Zvcm1zKCcuc2lnbnVwJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgICAvLyBTaG93IHNpZ24gdXAgZm9ybSBmcm9tIHNpZ251cFxuICAgICQoJy5sb2dpbi0tc2lnbnVwJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgc2hvd0Zvcm1zKCcuc2lnbnVwJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgICAvLyBTaG93IHNpZ24gdXAgZnJvbSBDVEFcbiAgICAkKCcuY3RhLS1zaWdudXAnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICBzaG93Rm9ybXMoJy5zaWdudXAnKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICAgIC8vIF4gQ09NQklORSBUSEVTRVxuXG4gICAgLy8gRGlzbWlzcyBmb3Jtc1xuICAgIC8vIExvZ2luXG4gICAgJCgnLmxvZ2luLS1kaXNtaXNzJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgY2xvc2VGb3JtcygnLmxvZ2luJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgICAvLyBTaWduIHVwXG4gICAgJCgnLnNpZ251cC0tZGlzbWlzcycpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgIGNsb3NlRm9ybXMoJy5zaWdudXAnKTtcbiAgICAgICAgcmVzZXRTaWdudXAoKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICAgIC8vIFByb3NwZWN0XG4gICAgJCgnLnByb3NwZWN0LS1kaXNtaXNzJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgY2xvc2VGb3JtcygnLnByb3NwZWN0Jyk7XG4gICAgICAgIHJlc2V0U2lnbnVwKCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgICAvLyBBdXRoXG4gICAgJCgnLmF1dGgtLWRpc21pc3MnKS5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICBjbG9zZUZvcm1zKCcuYXV0aCcpO1xuICAgICAgICByZXNldFNpZ251cCgpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gICAgLy8gU3VjY2Vzc1xuICAgICQoJy5zdWNjZXNzLS1kaXNtaXNzJykuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgY2xvc2VGb3JtcygnLnN1Y2Nlc3MnKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICAgIC8vIF4gQ09NQklORSBUSEVTRVxuXG4gICAgLy8gU2lnbnVwICYgUHJvc3BlY3QgRm9ybXNcbiAgICAvL1xuICAgIC8vIEF0dHJpYnV0aW9uIFByb3ZpZGVyc1xuXG4gICAgLy8gUHJvc3BlY3QgRm9ybVxuICAgICQoJy5hdHRyaWJ1dGlvbicpLmNsaWNrKGZ1bmN0aW9uKGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgLy8gSGlkZSBwcm92aWRlcnMsIHNob3cgY3JlZGVudGlhbHNcbiAgICAgICQoJy5wcm92aWRlcicpLnRvZ2dsZUNsYXNzKCdvbicpO1xuICAgICAgJCgnLmNyZWRlbnRpYWxzJykudG9nZ2xlQ2xhc3MoJ29uJyk7XG5cbiAgICAgIC8vIEFzc2lnbiBzZWxlY3QgYXR0cmlidXRpb24gcHJvdmlkZXIgdG8gZm9ybVxuICAgICAgdmFyIGF0dHJpYnV0aW9uID0gJCh0aGlzKS5hdHRyKCdpZCcpO1xuICAgICAgJCgnI2F0dHJpYnV0aW9uJykudmFsKGF0dHJpYnV0aW9uKTsgLy8gU2V0XG4gICAgICAkKCdpbnB1dFtuYW1lPVwiYXR0cmlidXRpb25Qcm92aWRlclwiXScpLnZhbChhdHRyaWJ1dGlvbik7IC8vIFNldFxuXG4gICAgICAvLyBTaG93IFByb3NwZWN0IGZvcm0gaWYgbm90IFRVTkUgY2xpZW50XG4gICAgICBpZihhdHRyaWJ1dGlvbiA9PT0gJ0FkanVzdCcgfHwgYXR0cmlidXRpb24gPT09ICdBcHBzZmx5ZXInKXtcbiAgICAgICAgJCgnLmF0dHItcHJvdmlkZXInKS50ZXh0KGF0dHJpYnV0aW9uICsgJyBhcyB5b3VyIGF0dHJpYnV0aW9uIHByb3ZpZGVyJyk7XG4gICAgICAgIGNsb3NlRm9ybXMoJy5zaWdudXAnKTtcbiAgICAgICAgc2hvd0Zvcm1zKCcucHJvc3BlY3QnKTtcbiAgICAgIH0gZWxzZSBpZihhdHRyaWJ1dGlvbiA9PT0gJ05vbmUnKSB7XG5cbiAgICAgICAgJCgnLmF0dHItcHJvdmlkZXInKS50ZXh0KCdubyBhdHRyaWJ1dGlvbiBwcm92aWRlcicpO1xuICAgICAgICBjbG9zZUZvcm1zKCcuc2lnbnVwJyk7XG4gICAgICAgIHNob3dGb3JtcygnLnByb3NwZWN0Jyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBTaG93IFRlcm1zXG4gICAgJCgnLnNob3ctdGVybXMnKS5jbGljayhmdW5jdGlvbihlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICQoJy5jcmVkZW50aWFscycpLnRvZ2dsZUNsYXNzKCdvbicpO1xuICAgICAgJCgnLnRlcm1zJykudG9nZ2xlQ2xhc3MoJ29uJyk7XG5cbiAgICB9KTtcblxuICAgIC8vIFNlcnZpY2VzIFVSTHMgKG5lZWQgdG8gYWRkIHN0YWdlIFVSTHMpXG4gICAgdmFyIEFQSV9VUkwgPSAnaHR0cHM6Ly9tdi1tYW5hZ2VyYXBpLnR1bmUuY29tJztcbiAgICB2YXIgV0VCQVBQX1VSTCA9ICdodHRwczovL2FwcC5tdWx0aXZlcnNlLmNvbSc7XG5cbiAgICAvLyBQb3N0IHRoZSBmb3JtIHRvIE1hcmtldG8gJiBzZW5kIHVzZXIgdG8gQXBwXG5cbiAgICAvLyBBdHRhY2ggYSBzdWJtaXQgaGFuZGxlciB0byB0aGUgc2lnbiB1cCBmb3JtXG4gICAgJCgnI3NpZ251cEZvcm0nKS5zdWJtaXQoZnVuY3Rpb24oIGV2ZW50ICkge1xuICAgICAgJCgnI3NpZ251cEZvcm0gLmVycm9yJykuaGlkZSgpO1xuXG4gICAgICAvLyBIaWRlIHRlcm1zXG4gICAgICAkKCcudGVybXMnKS50b2dnbGVDbGFzcygnb24nKTtcblxuICAgICAgLy8gU3RvcCBmb3JtIGZyb20gc3VibWl0dGluZyBub3JtYWxseVxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgLy8gR2V0IHNvbWUgdmFsdWVzIGZyb20gZWxlbWVudHMgb24gdGhlIHBhZ2U6XG4gICAgICB2YXIgJGZvcm0gPSAkKCB0aGlzICksXG4gICAgICAgIGZpcnN0bmFtZSA9ICRmb3JtLmZpbmQoICdpbnB1dFtuYW1lPVwiRmlyc3ROYW1lXCJdJyApLnZhbCgpLFxuICAgICAgICBsYXN0bmFtZSA9ICRmb3JtLmZpbmQoICdpbnB1dFtuYW1lPVwiTGFzdE5hbWVcIl0nICkudmFsKCksXG4gICAgICAgIGNvbXBhbnkgPSAkZm9ybS5maW5kKCAnaW5wdXRbbmFtZT1cIkNvbXBhbnlcIl0nICkudmFsKCksXG4gICAgICAgIGVtYWlsID0gJGZvcm0uZmluZCggJ2lucHV0W25hbWU9XCJlbWFpbFwiXScgKS52YWwoKSxcbiAgICAgICAgcGFzc3dvcmQgPSAkZm9ybS5maW5kKCAnaW5wdXRbbmFtZT1cInBhc3NcIl0nICkudmFsKCksXG4gICAgICAgIGF0dHJpYnV0aW9uID0gJGZvcm0uZmluZCggJ2lucHV0W25hbWU9XCJhdHRyaWJ1dGlvblwiXScgKS52YWwoKSxcbiAgICAgICAgdXJsID0gJGZvcm0uYXR0ciggJ2FjdGlvbicgKTtcblxuICAgICAgLy8gU2VuZCB0aGUgZGF0YSB1c2luZyBwb3N0XG4gICAgICB2YXIgc2lnbnVwID0gJC5hamF4KHtcbiAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogQVBJX1VSTCsnL3Nlc3Npb24nLFxuICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHsnZW1haWwnOiBlbWFpbCwgJ3Bhc3N3b3JkJzogcGFzc3dvcmR9KVxuICAgICAgICB9KTtcblxuICAgICAgLy8gUHV0IHRoZSByZXN1bHRzIGluIGEgZGl2XG4gICAgICBzaWdudXAuZG9uZShmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgaWYgKHR5cGVvZihkYXRhLnRva2VuKSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mKGRhdGEudG9rZW4udHlwZSkgIT09ICd1bmRlZmluZWQnICYmIGRhdGEudG9rZW4udHlwZSAhPT0gbnVsbCAmJiBkYXRhLnRva2VuLnR5cGUgPT0gJzJmYWN0b3InICYmIGRhdGEudG9rZW4udG9rZW4gIT09IG51bGwpIHtcbiAgICAgICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKCdsb2FkaW5nJyk7XG4gICAgICAgICAgIHZhciBhMmZUb2tlbiA9IGRhdGEudG9rZW4udG9rZW47XG4gICAgICAgICAgICQoJyN0d29GYWN0b3JGb3JtJykuYXR0cignYXV0aF90b2tlbicsIGEyZlRva2VuKTtcbiAgICAgICAgICAgJCgnI3R3b0ZhY3RvckZvcm0nKS5hdHRyKCdlbWFpbCcsIGVtYWlsKTtcbiAgICAgICAgICAgc2hvd0Zvcm1zKCcuYXV0aCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBzZXNzaW9uX3Rva2VuID0gZGF0YS50b2tlbi50b2tlbjtcbiAgICAgICAgICBjcmVhdGVDb29raWUoJ3Nlc3Npb25Db29raWUnLCBzZXNzaW9uX3Rva2VuKTtcblxuICAgICAgICAgIC8vIFNlbmQgbGVhZCBkYXRhIHRvIE1hcmtldG9cbiAgICAgICAgICB2YXIgbWFya2V0b0Zvcm0gPSBNa3RvRm9ybXMyLmdldEZvcm0oMTA5OSk7XG4gICAgICAgICAgbWFya2V0b0Zvcm0uYWRkSGlkZGVuRmllbGRzKHtcbiAgICAgICAgICAgIC8vVGhlc2UgYXJlIHRoZSB2YWx1ZXMgd2hpY2ggd2lsbCBiZSBzdWJtaXR0ZWQgdG8gTWFya2V0b1xuICAgICAgICAgICAgJ0ZpcnN0TmFtZSc6Zmlyc3RuYW1lLFxuICAgICAgICAgICAgJ0xhc3ROYW1lJzpsYXN0bmFtZSxcbiAgICAgICAgICAgICdDb21wYW55Jzpjb21wYW55LFxuICAgICAgICAgICAgJ0VtYWlsJzplbWFpbCxcbiAgICAgICAgICAgICdhdHRyaWJ1dGlvblByb3ZpZGVyJzphdHRyaWJ1dGlvblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgbWFya2V0b0Zvcm0uc3VibWl0KCk7XG4gICAgICAgICAgbWFya2V0b0Zvcm0ub25TdWNjZXNzKGZ1bmN0aW9uKHZhbHVlcywgZm9sbG93VXBVcmwpIHtcbiAgICAgICAgICAgIC8vIFRha2UgdGhlIHVzZXIgdG8gdGhlIGFwcFxuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UoV0VCQVBQX1VSTCsnL2xvZ2luLycrc2Vzc2lvbl90b2tlbik7XG5cbiAgICAgICAgICAgIC8vIElmIHRoZXJlIGlzIG9uZSwgcHJldmVudCB0aGUgZm9ybSBmcm9tIHRha2luZyB0aGUgbGVhZCB0byB0aGUgZm9sbG93IHVwIHVybFxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBzaWdudXAuZXJyb3IoZnVuY3Rpb24oaHR0cE9iaiwgdGV4dFN0YXR1cykge1xuICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0gaHR0cE9iai5zdGF0dXMgPT09IDQxOCA/ICdFcnJvcjogVW5mb3J0dW5hdGVseSwgb25seSBUTUMgQUEgdXNlcnMgd2l0aCBhZG1pbmlzdHJhdG9yIHBlcm1pc3Npb25zIG1heSB1c2UgTXVsdGl2ZXJzZS4gUGxlYXNlIHdvcmsgd2l0aCBhIHRlYW0gbWVtYmVyIHRoYXQgaGFzIGFkbWluaXN0cmF0b3IgYWNjZXNzIHRvIHVzZSBNdWx0aXZlcnNlLidcbiAgICAgICAgICA6ICdGYWlsZWQgdG8gYXV0aGVudGljYXRlLiBQbGVhc2UgY2hlY2sgeW91ciBlLW1haWwgYW5kIHBhc3N3b3JkLic7XG4gICAgICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygnbG9hZGluZycpO1xuICAgICAgICAvL3Nob3dGb3JtcygnLnNpZ251cCcpO1xuICAgICAgICAkKCcuY3JlZGVudGlhbHMnKS50b2dnbGVDbGFzcygnb24nKTtcbiAgICAgICAgJCgnI3NpZ251cEZvcm0gLmVycm9yJykudGV4dChlcnJvck1lc3NhZ2UpO1xuICAgICAgICAkKCcjc2lnbnVwRm9ybSAuZXJyb3InKS5zaG93KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIEludHJvIExvZ2luXG4gICAgJCgnI2xvZ2luJykuc3VibWl0KGZ1bmN0aW9uKCBldmVudCApIHtcbiAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnbG9hZGluZycpO1xuICAgICAgJCgnI2xvZ2luRm9ybSAuZXJyb3InKS5oaWRlKCk7XG5cbiAgICAgIC8vIFN0b3AgZm9ybSBmcm9tIHN1Ym1pdHRpbmcgbm9ybWFsbHlcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIC8vIEdldCBzb21lIHZhbHVlcyBmcm9tIGVsZW1lbnRzIG9uIHRoZSBwYWdlOlxuICAgICAgdmFyICRmb3JtID0gJCggdGhpcyApLFxuICAgICAgICBlbWFpbCA9ICRmb3JtLmZpbmQoICdpbnB1dFtuYW1lPVwiZW1haWxcIl0nICkudmFsKCksXG4gICAgICAgIHBhc3N3b3JkID0gJGZvcm0uZmluZCggJ2lucHV0W25hbWU9XCJwYXNzXCJdJyApLnZhbCgpO1xuXG4gICAgICAvLyBTZW5kIHRoZSBkYXRhIHVzaW5nIHBvc3RcbiAgICAgIHZhciBwb3N0aW5nID0gJC5hamF4KHtcbiAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICB1cmw6IEFQSV9VUkwrJy9zZXNzaW9uJyxcbiAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoeydlbWFpbCc6IGVtYWlsLCAncGFzc3dvcmQnOiBwYXNzd29yZH0pXG4gICAgICB9KTtcblxuICAgICAgLy8gUmVzdWx0c1xuICAgICAgcG9zdGluZy5kb25lKGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICBpZiAodHlwZW9mKGRhdGEudG9rZW4pICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YoZGF0YS50b2tlbi50eXBlKSAhPT0gJ3VuZGVmaW5lZCcgJiYgZGF0YS50b2tlbi50eXBlICE9PSBudWxsICYmIGRhdGEudG9rZW4udHlwZSA9PSAnMmZhY3RvcicgJiYgZGF0YS50b2tlbi50b2tlbiAhPT0gbnVsbCkge1xuICAgICAgICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygnbG9hZGluZycpO1xuICAgICAgICAgIHZhciBhMmZUb2tlbiA9IGRhdGEudG9rZW4udG9rZW47XG4gICAgICAgICAgJCgnI3R3b0ZhY3RvckZvcm0nKS5hdHRyKCdhdXRoX3Rva2VuJywgYTJmVG9rZW4pO1xuICAgICAgICAgICQoJyN0d29GYWN0b3JGb3JtJykuYXR0cignZW1haWwnLCBlbWFpbCk7XG4gICAgICAgICAgc2hvd0Zvcm1zKCcuYXV0aCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBzZXNzaW9uX3Rva2VuID0gZGF0YS50b2tlbi50b2tlbjtcbiAgICAgICAgICBjcmVhdGVDb29raWUoJ3Nlc3Npb25Db29raWUnLCBzZXNzaW9uX3Rva2VuKTtcbiAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZShXRUJBUFBfVVJMKycvbG9naW4vJytzZXNzaW9uX3Rva2VuKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBwb3N0aW5nLmVycm9yKGZ1bmN0aW9uKGh0dHBPYmosIHRleHRTdGF0dXMpIHtcbiAgICAgICAgLy8gU2hvdyBtYWluIGxvZ2luIGFuZCBhZGQgZXJyb3IgbWVzc2FnZXNcbiAgICAgICAgc2hvd0Zvcm1zKCcubG9naW4nKTtcbiAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IGh0dHBPYmouc3RhdHVzID09PSA0MTggPyAnRXJyb3I6IFVuZm9ydHVuYXRlbHksIG9ubHkgVE1DIEFBIHVzZXJzIHdpdGggYWRtaW5pc3RyYXRvciBwZXJtaXNzaW9ucyBtYXkgdXNlIE11bHRpdmVyc2UuIFBsZWFzZSB3b3JrIHdpdGggYSB0ZWFtIG1lbWJlciB0aGF0IGhhcyBhZG1pbmlzdHJhdG9yIGFjY2VzcyB0byB1c2UgTXVsdGl2ZXJzZS4nXG4gICAgICAgICAgOiAnRmFpbGVkIHRvIGF1dGhlbnRpY2F0ZS4gUGxlYXNlIGNoZWNrIHlvdXIgZS1tYWlsIGFuZCBwYXNzd29yZC4nO1xuICAgICAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcnKTtcbiAgICAgICAgJCgnI2xvZ2luRm9ybSAuZXJyb3InKS50ZXh0KGVycm9yTWVzc2FnZSk7XG4gICAgICAgICQoJyNsb2dpbkZvcm0gLmVycm9yJykuc2hvdygpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBNYWluIExvZ2luXG4gICAgLy8gQXR0YWNoIGEgc3VibWl0IGhhbmRsZXIgdG8gdGhlIHNpZ24gdXAgZm9ybVxuICAgICQoJyNsb2dpbkZvcm0nKS5zdWJtaXQoZnVuY3Rpb24oIGV2ZW50ICkge1xuICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdsb2FkaW5nJyk7XG4gICAgICAkKCcjbG9naW5Gb3JtIC5lcnJvcicpLmhpZGUoKTtcblxuICAgICAgLy8gU3RvcCBmb3JtIGZyb20gc3VibWl0dGluZyBub3JtYWxseVxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgLy8gR2V0IHNvbWUgdmFsdWVzIGZyb20gZWxlbWVudHMgb24gdGhlIHBhZ2U6XG4gICAgICB2YXIgJGZvcm0gPSAkKCB0aGlzICksXG4gICAgICAgIGVtYWlsID0gJGZvcm0uZmluZCggJ2lucHV0W25hbWU9XCJlbWFpbFwiXScgKS52YWwoKSxcbiAgICAgICAgcGFzc3dvcmQgPSAkZm9ybS5maW5kKCAnaW5wdXRbbmFtZT1cInBhc3NcIl0nICkudmFsKCk7XG5cbiAgICAgIC8vIFNlbmQgdGhlIGRhdGEgdXNpbmcgcG9zdFxuICAgICAgdmFyIHBvc3RpbmcgPSAkLmFqYXgoe1xuICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgIHVybDogQVBJX1VSTCsnL3Nlc3Npb24nLFxuICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7J2VtYWlsJzogZW1haWwsICdwYXNzd29yZCc6IHBhc3N3b3JkfSlcbiAgICAgIH0pO1xuXG4gICAgICAvLyBSZXN1bHRzXG4gICAgICBwb3N0aW5nLmRvbmUoZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgIGlmICh0eXBlb2YoZGF0YS50b2tlbikgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZihkYXRhLnRva2VuLnR5cGUpICE9PSAndW5kZWZpbmVkJyAmJiBkYXRhLnRva2VuLnR5cGUgIT09IG51bGwgJiYgZGF0YS50b2tlbi50eXBlID09ICcyZmFjdG9yJyAmJiBkYXRhLnRva2VuLnRva2VuICE9PSBudWxsKSB7XG4gICAgICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKCdsb2FkaW5nJyk7XG4gICAgICAgICAgdmFyIGEyZlRva2VuID0gZGF0YS50b2tlbi50b2tlbjtcbiAgICAgICAgICAkKCcjdHdvRmFjdG9yRm9ybScpLmF0dHIoJ2F1dGhfdG9rZW4nLCBhMmZUb2tlbik7XG4gICAgICAgICAgJCgnI3R3b0ZhY3RvckZvcm0nKS5hdHRyKCdlbWFpbCcsIGVtYWlsKTtcbiAgICAgICAgICBzaG93Rm9ybXMoJy5hdXRoJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHNlc3Npb25fdG9rZW4gPSBkYXRhLnRva2VuLnRva2VuO1xuICAgICAgICAgIGNyZWF0ZUNvb2tpZSgnc2Vzc2lvbkNvb2tpZScsIHNlc3Npb25fdG9rZW4pO1xuICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKFdFQkFQUF9VUkwrJy9sb2dpbi8nK3Nlc3Npb25fdG9rZW4pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHBvc3RpbmcuZXJyb3IoZnVuY3Rpb24oaHR0cE9iaiwgdGV4dFN0YXR1cykge1xuICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0gaHR0cE9iai5zdGF0dXMgPT09IDQxOCA/ICdFcnJvcjogVW5mb3J0dW5hdGVseSwgb25seSBUTUMgQUEgdXNlcnMgd2l0aCBhZG1pbmlzdHJhdG9yIHBlcm1pc3Npb25zIG1heSB1c2UgTXVsdGl2ZXJzZS4gUGxlYXNlIHdvcmsgd2l0aCBhIHRlYW0gbWVtYmVyIHRoYXQgaGFzIGFkbWluaXN0cmF0b3IgYWNjZXNzIHRvIHVzZSBNdWx0aXZlcnNlLidcbiAgICAgICAgICA6ICdGYWlsZWQgdG8gYXV0aGVudGljYXRlLiBQbGVhc2UgY2hlY2sgeW91ciBlLW1haWwgYW5kIHBhc3N3b3JkLic7XG4gICAgICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygnbG9hZGluZycpO1xuICAgICAgICAkKCcjbG9naW5Gb3JtIC5lcnJvcicpLnRleHQoZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgJCgnI2xvZ2luRm9ybSAuZXJyb3InKS5zaG93KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIENvbXBsZXRlIDJmYWN0b3IgYXV0aCBmb3Igc2lnbmluXG4gICAgLy8gQXR0YWNoIGEgc3VibWl0IGhhbmRsZXIgdG8gdGhlIDJmYWN0b3IgZm9ybVxuICAgICQoJyN0d29GYWN0b3JGb3JtJykuc3VibWl0KGZ1bmN0aW9uKCBldmVudCApIHtcbiAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnbG9hZGluZycpO1xuICAgICAgJCgnI3R3b0ZhY3RvckZvcm0gLmVycm9yJykuaGlkZSgpO1xuXG4gICAgICAvLyBTdG9wIGZvcm0gZnJvbSBzdWJtaXR0aW5nIG5vcm1hbGx5XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAvLyBHZXQgc29tZSB2YWx1ZXMgZnJvbSBlbGVtZW50cyBvbiB0aGUgcGFnZTpcbiAgICAgIHZhciAkZm9ybSA9ICQoIHRoaXMgKSxcbiAgICAgICAgY29kZSA9ICRmb3JtLmZpbmQoICdpbnB1dFtuYW1lPVwiY29kZVwiXScgKS52YWwoKSxcbiAgICAgICAgZW1haWwgPSAkKCcjdHdvRmFjdG9yRm9ybScpLmF0dHIoJ2VtYWlsJyksXG4gICAgICAgIGF1dGhfdG9rZW4gPSAkKCcjdHdvRmFjdG9yRm9ybScpLmF0dHIoJ2F1dGhfdG9rZW4nKTtcblxuICAgICAgLy8gU2VuZCB0aGUgZGF0YSB1c2luZyBwb3N0XG4gICAgICB2YXIgcG9zdGluZyA9ICQuYWpheCh7XG4gICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6IEFQSV9VUkwrJy9zZXNzaW9uJyxcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7ICdhdXRoX3Rva2VuJzogYXV0aF90b2tlbiwgJ2NvZGUnOiBjb2RlIH0pXG4gICAgICAgIH0pO1xuXG4gICAgICAvLyBSZXN1bHRzXG4gICAgICBwb3N0aW5nLmRvbmUoZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgIGlmICh0eXBlb2YoZGF0YS5lcnJvcl9tc2cpICE9PSAndW5kZWZpbmVkJyAmJiBkYXRhLmVycm9yX21zZyAhPT0gbnVsbCkge1xuICAgICAgICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygnbG9hZGluZycpO1xuICAgICAgICAgICQoJyN0d29GYWN0b3JGb3JtIC5lcnJvcicpLnRleHQoZGF0YS5lcnJvcl9tc2cpO1xuICAgICAgICAgICQoJyN0d29GYWN0b3JGb3JtIC5lcnJvcicpLnNob3coKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgc2Vzc2lvbl90b2tlbiA9IGRhdGEudG9rZW4udG9rZW47XG4gICAgICAgICAgY3JlYXRlQ29va2llKCdzZXNzaW9uQ29va2llJywgc2Vzc2lvbl90b2tlbik7XG4gICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UoV0VCQVBQX1VSTCsnL2xvZ2luLycrc2Vzc2lvbl90b2tlbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcG9zdGluZy5lcnJvcihmdW5jdGlvbihodHRwT2JqLCB0ZXh0U3RhdHVzKSB7XG4gICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSAnRmFpbGVkIHRvIGF1dGhlbnRpY2F0ZS4gSW52YWxpZCB2ZXJpZmljYXRpb24gY29kZS4nO1xuICAgICAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcnKTtcbiAgICAgICAgJCgnI3R3b0ZhY3RvckZvcm0gLmVycm9yJykudGV4dChlcnJvck1lc3NhZ2UpO1xuICAgICAgICAkKCcjdHdvRmFjdG9yRm9ybSAuZXJyb3InKS5zaG93KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIE1hcmtldG8gRm9ybSBTdWNjZXNzICYgVGhhbmsgWW91IE1lc3NhZ2VzXG5cbiAgICAvLyBPbiBzdWNjZXNzZnVsIG1hcmtldG8gcHJvc3BlY3QgZm9ybSBzdWJtaXQgd2Ugc2hvdWxkIGJlIHJldHVybmVkIHRvIG11bHRpdmVyc2UuY29tIHdpdGggYSB0aGFuayB5b3UgcXVlcnkgcGFyYW1cbiAgICAvLyBHZXQgdGhlIHF1ZXJ5IHBhcmFtZXRlclxuICAgIHZhciBnZXRQYXJhbWV0ZXJCeU5hbWUgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW10vLCBcIlxcXFxbXCIpLnJlcGxhY2UoL1tcXF1dLywgXCJcXFxcXVwiKTtcbiAgICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiW1xcXFw/Jl1cIiArIG5hbWUgKyBcIj0oW14mI10qKVwiKSxcbiAgICAgICAgICAgICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWMobG9jYXRpb24uc2VhcmNoKTtcbiAgICAgICAgICByZXR1cm4gcmVzdWx0cyA9PT0gbnVsbCA/IFwiXCIgOiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1sxXS5yZXBsYWNlKC9cXCsvZywgXCIgXCIpKTtcbiAgICAgIH07IC8vXG5cbiAgICB2YXIgcGFyYW0gPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ21lc3NhZ2UnKTtcblxuICAgIC8vIElmIGl0IHdhcyBzdWNjZXNzZnVsIHNob3cgdGhlIHRoYW5rIHlvdSBtZXNzYWdlXG4gICAgaWYgKCBwYXJhbSA9PT0gJ3RoYW5rLXlvdScgKSB7XG4gICAgICBzaG93Rm9ybXMoJy5zdWNjZXNzJyk7XG4gICAgfVxuXG4gICAgLy8gRU5EIFNJR05VUCAmIExPR0lOIFNFUlZJQ0VTXG5cbiAgfSk7XG5cbn0pKGpRdWVyeSwgd2luZG93LCBkb2N1bWVudCk7XG4iXX0=
